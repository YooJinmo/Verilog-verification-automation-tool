name: Verilog Verification Automation

on:
  schedule:
    - cron: "*/1 * * * *"  # 매 1분마다 실행
  workflow_dispatch:  # 수동 실행 가능

jobs:
  run_verification:
    runs-on: ubuntu-latest

    steps:
    - name: 저장소 체크아웃
      uses: actions/checkout@v3
      with:
        token: ${{secrets.GITHUB_TOKEN}}

    - name: Python & Verilog 환경 설정
      uses: actions/setup-python@v4
      with:
        python-version: "3.9"

    - name: 필요한 패키지 설치
      run: |
        sudo apt update
        pip install pyverilog

    - name: Full Adder Python 실행
      run: python src/run_python_adder.py

    - name: Full Adder Verilog 실행
      run: python src/run_verilog.py

    - name: 결과 비교
      run: python src/compare_files.py

    - name: 결과를 csv 파일로 저장
      run: python src/save_to_csv.py
      
    - name: 변경 사항 커밋 및 푸시
      run: |
        git config --global user.name "github-actions[bot]"
        git config --global user.email "github-actions@github.com"
        git add result.csv # 날씨 데이터 저장 csv를 github에 추가
        git commit -m "Update result.csv (auto)" # 변경 사항이 있을 경우 commit
        git push # 변경 사항을 git에 push

      continue-on-error: true #파일 변경이 없을 경우 오류 무시
      
